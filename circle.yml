machine:
  environment:
    FILENAME: report

dependencies:
  cache_directories:
    - "~/.apt-cache"
  pre:
    - |
      sudo rm -rf /var/cache/apt/archives && \
      sudo ln -s ~/.apt-cache /var/cache/apt/archives && \
      mkdir -p ~/.apt-cache/partial
  override:
    - sudo apt-get update
    - sudo apt-get install -y texlive texlive-xetex texlive-latex-extra pandoc lmodern

test:
  override:
    - |
      pandoc --highlight-style pygments --mathjax \
             --latex-engine=pdflatex "$FILENAME.tex" -o "$FILENAME.pdf"
      cp -r "$FILENAME.pdf" $CIRCLE_ARTIFACTS/
